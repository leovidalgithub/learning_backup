<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>async-await-fetch-promise</title>
		<style>
			body {
				background-color: #333;
			}
		</style>
	</head>
	<body>
		<script>
			// https://bluuweb.github.io/vue-udemy/01-fundamentos/

			// ------------------- ------------------- ------------------- ------------------- ------------------- -------------------
			// example 1
			// const postData = async function (url = "", data = {}) {
			// 	const response = await fetch(url, {
			// 	method: "GET", // *GET, POST, PUT, DELETE, etc.
			// 	mode: "cors", // no-cors, *cors, same-origin
			// 	cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
			// 	credentials: "same-origin", // include, *same-origin, omit
			// 	headers: {
			// 		"Content-Type": "application/json" // 'application/x-www-form-urlencoded',
			// 	},
			// 	redirect: "follow", // manual, *follow, error
			// 	referrerPolicy: "no-referrer" // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
			// 	// body: JSON.stringify(data) // body data type must match "Content-Type" header
			// 	})
			// 	// return response.json(); // parses JSON response into native JavaScript objects
			// 	return response;
			// }

			// postData("https://pokeapi.co/api/v2/pokemon/", { answer: 42 })
			// 	.then(res => res.json())
			// 	.then(data => {
			// 		console.log('postData() --> then()');
			// 		data.results.forEach((element) => {
			// 			console.log(element.name)
			// 		});
			// 	})
			// 	.catch(error => console.log(error))
			// 	.finally(() => console.log('postData() --> finally()'));

			// ------------------- ------------------- ------------------- ------------------- ------------------- -------------------
			// example 2
			// (async () => {
			// 		try {
			// 			const res = await fetch("https://pokeapi.co/api/v2/pokemon/");
			// 			const data = await res.json();
			// 			const arrayPokemonsOnlyNames = data.results.map(element => element.name);
			// 			const arrayPokemonsFilterExample = data.results.filter(element => element.name !== "bulbasaur");

			// 			console.log('data', data);
			// 			console.log('arrayPokemonsOnlyNames', arrayPokemonsOnlyNames);
			// 			console.log('arrayPokemonsFilterExample', arrayPokemonsFilterExample);

			// 		} catch (error) {
			// 			console.log(error);
			// 		}
			// 	}
			// )();

			// ------------------- ------------------- ------------------- ------------------- ------------------- -------------------
			// example 3
			// const puppeteer = () => {
			// 	console.log('fetching data from //puppeteer.leovidal.es/data');
			// 	fetch('http://puppeteer.leovidal.es/data')
			// 		.then(res => res.json())
			// 		.then(data => console.log('.then()', data))
			// 		.catch(err => console.log('.catch()', err))
			// 		.finally(() => console.log('.finally()'))
			// }
			// puppeteer()

			// ------------------- ------------------- ------------------- ------------------- ------------------- -------------------
			// example 4 - callback
			// const doAsyncStuffWithCallback = (num1, num2, callback) => {
			// 	let result = num1 + num2;
			// 	setTimeout(() => {
			// 		callback(result);
			// 	}, 2000)
			// }

			// doAsyncStuffWithCallback(2, 3, (result) => {
			// 	console.log('doAsyncStuffWithCallback() --> ', result);
			// });

			// ------------------- ------------------- ------------------- ------------------- ------------------- -------------------
			// example 5 - promises

				const doAsyncStuffWithPromises = (num1, num2) => {
					let result = num1 + num2;

					return new Promise((resolve, reject) => {
						let rdm = Math.floor(Math.random() * 2);
						setTimeout(() => {
							if (rdm === 1) {
								resolve(result);
							} else {
								reject(result);
							}
						}, 1000)
					})
				}

				let repeat = setInterval(() => {
					doAsyncStuffWithPromises(4, 5)
						.then(result => {
							console.log('doAsyncStuffWithPromises() .then() --> ', result);
						})
						.catch(msg => {
							console.log('doAsyncStuffWithPromises() .catch() -->', msg);
						})
						.finally(() => console.log('doAsyncStuffWithPromises() .finally()'))
				}, 2000);

				(async () => {
					let myresult = await doAsyncStuffWithPromises(7, 8);
					if (myresult) {
						console.log('async await --> doAsyncStuffWithPromises() --> ', myresult);
					} else {
						console.log('async await --> doAsyncStuffWithPromises() --> FAILED!');
					}
				})()
		</script>
	</body>
</html>